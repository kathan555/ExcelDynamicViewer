<Window x:Class="ExcelDynamicViewer.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:converters="clr-namespace:ExcelDynamicViewer.Converters" 
        xmlns:viewModels="clr-namespace:ExcelDynamicViewer.ViewModels"
        mc:Ignorable="d"
        d:DataContext="{d:DesignInstance Type=viewModels:MainViewModel}"
        Title="Excel Dynamic Viewer" 
        WindowState="Maximized">

    <Window.Resources>
        <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>

        <!-- DataGrid Style -->
        <Style x:Key="ModernDataGrid" TargetType="DataGrid">
            <Setter Property="Background" Value="White"/>
            <Setter Property="RowBackground" Value="White"/>
            <Setter Property="AlternatingRowBackground" Value="#FAFAFA"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="GridLinesVisibility" Value="None"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Setter Property="SelectionMode" Value="Extended"/>
            <Setter Property="SelectionUnit" Value="FullRow"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
            <Setter Property="CanUserReorderColumns" Value="True"/>
            <Setter Property="CanUserResizeRows" Value="False"/>
            <Setter Property="CanUserSortColumns" Value="True"/>
            <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="HorizontalScrollBarVisibility" Value="Auto"/>
            <Setter Property="CellStyle">
                <Setter.Value>
                    <Style TargetType="DataGridCell">
                        <Setter Property="Padding" Value="12,8"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                        <Style.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="#E3F2FD"/>
                                <Setter Property="Foreground" Value="Black"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Setter.Value>
            </Setter>
            <Setter Property="ColumnHeaderStyle">
                <Setter.Value>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="#673AB7"/>
                        <Setter Property="Foreground" Value="White"/>
                        <Setter Property="FontWeight" Value="Bold"/>
                        <Setter Property="Padding" Value="12,8"/>
                        <Setter Property="BorderThickness" Value="0"/>
                    </Style>
                </Setter.Value>
            </Setter>
            <Setter Property="RowStyle">
                <Setter.Value>
                    <Style TargetType="DataGridRow">
                        <Setter Property="BorderBrush" Value="#EEEEEE"/>
                        <Setter Property="BorderThickness" Value="0,0,0,1"/>
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#F5F5F5"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Setter.Value>
            </Setter>
        </Style>
       
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" 
                Background="#673AB7" 
                Padding="16">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="📊" 
                         FontSize="20" 
                         Margin="0,0,12,0"
                         VerticalAlignment="Center"/>

                <TextBlock Text="Excel Dynamic Viewer" 
                         FontSize="18" 
                         FontWeight="Bold"
                         Foreground="White"
                         VerticalAlignment="Center"/>

                <Button Command="{Binding LoadExcelCommand}"
                      Content="Load Excel File"
                      Margin="24,0,0,0"
                      Background="#FFEB3B"
                      Foreground="#333333"
                      BorderThickness="0"
                      Height="36"
                      Padding="16,0"
                      FontWeight="Bold"
                      Cursor="Hand"/>
            </StackPanel>
        </Border>

        <!-- Data Grid Container -->
        <!--<DataGrid Grid.Row="1"
                ItemsSource="{Binding ExcelData}"
                BorderThickness="1"
                AutoGenerateColumns="False"
                VerticalScrollBarVisibility="Auto">

            <DataGrid.Columns>
                <DataGridTextColumn Header="#" 
                                    Width="Auto"
                                    Binding="{Binding Index}"
                                    IsReadOnly="True" />
                
                <DataGridTemplateColumn Header="Properties" 
                                      Width="*"
                                      IsReadOnly="True">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <ItemsControl Background="LightCoral"
                                          ItemsSource="{Binding Data}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate >
                                        <UniformGrid Rows="{Binding DataContext.UniformGridRows, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}}" 
                                                     Columns="{Binding DataContext.UniformGridColumns, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}}" />
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>

                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="LightBlue" 
                                                BorderBrush="Black"
                                                BorderThickness="1"
                                                Margin="0"
                                                Height="30">
                                            <TextBlock Text="{Binding Value}"
                                                       VerticalAlignment="Center"
                                                       HorizontalAlignment="Center"
                                                       Foreground="Black"/>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>-->
        <DataGrid Grid.Row="1" 
                  x:Name="ExcelDataGrid"
                  ItemsSource="{Binding ExcelData}"
                  Style="{StaticResource ModernDataGrid}"
                  AutoGeneratingColumn="ExcelDataGrid_OnAutoGeneratingColumn">
        </DataGrid>

        <!-- Status Bar -->
        <Border Grid.Row="2" 
                Background="#F5F5F5" 
                BorderThickness="0,1,0,0" 
                BorderBrush="#E0E0E0"
                Padding="8,4">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Text="{Binding StatusMessage}" 
                         VerticalAlignment="Center"
                         Foreground="#666666"/>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock Text="{Binding ExcelData.Count, StringFormat='{}Rows: {0}'}"
                             Margin="0,0,16,0"
                             VerticalAlignment="Center"
                             Foreground="#666666"/>
                    <TextBlock Text="{Binding Columns.Count, StringFormat='{}Columns: {0}'}"
                             VerticalAlignment="Center"
                             Foreground="#666666"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>